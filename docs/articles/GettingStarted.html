<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with dsims • dsims</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with dsims">
<meta name="description" content="Assessing behaviour of a survey before going into the field
">
<meta property="og:description" content="Assessing behaviour of a survey before going into the field
">
<script type="text/javascript"> (function(c,l,a,r,i,t,y){ c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}; t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i; y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window, document, "clarity", "script", "m9ts0haeya");</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsims</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/GettingStarted.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/dsims-examples.html">Transition from `DSsim` to `dsims`</a></li>
    <li><a class="dropdown-item" href="../articles/dsims_grouped_strata.html">Grouped strata</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/dsims/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with dsims</h1>
                        <h4 data-toc-skip class="author">L. Marshall</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">April 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/dsims/blob/HEAD/vignettes/GettingStarted.Rmd" class="external-link"><code>vignettes/GettingStarted.Rmd</code></a></small>
      <div class="d-none name"><code>GettingStarted.Rmd</code></div>
    </address>
</div>

    
    
<div class="section level2">
<h2 id="distance-sampling-simulations">Distance Sampling Simulations<a class="anchor" aria-label="anchor" href="#distance-sampling-simulations"></a>
</h2>
<p>This vignette introduces the basic procedure for setting up and running a distance sampling simulation using ‘dsims’ <span class="citation">(Laura Marshall 2023a)</span>. The ‘dsims’ package uses the distance sampling survey design package ‘dssd’ <span class="citation">(Laura Marshall 2023b)</span> to define the design and generate the surveys (sets of transects). For further details on defining designs please refer to the ‘dssd’ vignettes. ‘dsims’ was designed to be largely similar to the ‘DSsim’ package <span class="citation">(L. Marshall 2020)</span> in terms of work flow, functions and arguments. The main differences in terms of its use lie in the definition of the designs which can now be generated in R using the ‘dssd’ package (these packages are automatically linked) and the definition of analyses. Analyses are now defined using terminology based on the ‘Distance’ package <span class="citation">(Miller et al. 2019)</span>. In addition, the underlying functionality now makes use of the ‘sf’ package <span class="citation">(Pebesma and Baston 2021)</span>.</p>
<p>Distance Sampling techniques provide design based estimates of density and abundance for populations. The accuracy of these estimates relies on valid survey design. While general rules of thumb can help guide our design choices, simulations emulating a specific set of survey characteristics can often help us achieve more efficient and robust designs for individual studies. For example, simulations can help us investigate how effort allocation can affect our estimates or the effects of a more efficient design which has less uniform coverage probability. Due to the individual nature of each study, each with their specific set of characteristics, simulation can be a powerful tool in evaluating survey design.</p>
</div>
<div class="section level2">
<h2 id="setting-up-the-region">Setting up the Region<a class="anchor" aria-label="anchor" href="#setting-up-the-region"></a>
</h2>
<p>We will use the St Andrews bay area as an example study region for these simulations. This is a single strata study region which has been projected into metres. We will first load the ‘dsims’ package, this will also automatically load the ‘dssd’ package. As this shapefile does not have a projection recorded (in an associated .prj file) we tell ‘dsims’ that the units are metres.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/dsims" class="external-link">dsims</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: dssd</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find the file path to the example shapefile in dssd</span></span>
<span><span class="va">shapefile.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"StAndrew.shp"</span>, package <span class="op">=</span> <span class="st">"dssd"</span><span class="op">)</span></span>
<span><span class="co"># Create the survey region object</span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dssd/man/make.region.html" class="external-link">make.region</a></span><span class="op">(</span>region.name <span class="op">=</span> <span class="st">"St Andrews bay"</span>,</span>
<span>                      shape <span class="op">=</span> <span class="va">shapefile.name</span>,</span>
<span>                      units <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:region"></span>
<img src="GettingStarted_files/figure-html/region-1.png" alt="The study region."><p class="caption">
Figure 1: The study region.
</p>
</div>
</div>
<div class="section level2">
<h2 id="defining-the-study-population">Defining the study population<a class="anchor" aria-label="anchor" href="#defining-the-study-population"></a>
</h2>
<p>To define a study population we require a number of intermediate steps. We describe these in turn below.</p>
<div class="section level3">
<h3 id="population-density-grid">Population Density Grid<a class="anchor" aria-label="anchor" href="#population-density-grid"></a>
</h3>
<p>The first step in defining your study population is to set up the density grid. One way to do this is to first create a flat surface and then add hot and low spots to represent where you think you might have areas of higher and lower density of animals.</p>
<p>If we were to assume that there were 300 groups in the St Andrews bay study area (which is a fairly large number!) this would only give us an average density of 3.04-07 groups per square metre. For this simulation, as we will use a fixed population size, we do not need to worry about the absolute values of the density surface. Instead, it can be simpler to work with larger values and be aware that we are defining a relative density surface. So where we create a surface to have a density of twice that in another area that relationship will be maintained (be it at much smaller absolute values) when we later generate the population.</p>
<p>For the purposes of simulation you will likely want to test over a range of plausible animal distributions (if you knew exactly how many you were going to find at any given location you probably wouldn’t be doing the study!). When testing non-uniform coverage designs it is advisable to try out worst case scenarios, i.e. set density in the area of higher or lower coverage to differ from the majority of the survey region. This will give an idea of the degree of potential bias which could be introduced.</p>
<p>In this example, for the equal spaced zigzag design, as it is generated in a convex hull the areas with differing coverage are likely to be at the very top and very bottom of the survey region. In the density grid below these areas are shown to have lower animal density than the rest of the survey region, a likely scenario when a study region has been constructed in order to catch the range of a population of interest.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We first create a flat density grid</span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.density.html">make.density</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                        x.space <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                        constant <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now we can add some high and low points to give some spatial variability</span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.hotspot-methods.html">add.hotspot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">density</span>,</span>
<span>                       centre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">170000</span>, <span class="fl">6255000</span><span class="op">)</span>,</span>
<span>                       sigma <span class="op">=</span> <span class="fl">8000</span>,</span>
<span>                       amplitude <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.hotspot-methods.html">add.hotspot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">density</span>,</span>
<span>                       centre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">160000</span>, <span class="fl">6275000</span><span class="op">)</span>,</span>
<span>                       sigma <span class="op">=</span> <span class="fl">6000</span>,</span>
<span>                       amplitude <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.hotspot-methods.html">add.hotspot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">density</span>,</span>
<span>                       centre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">155000</span>, <span class="fl">6260000</span><span class="op">)</span>,</span>
<span>                       sigma <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>                       amplitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.hotspot-methods.html">add.hotspot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">density</span>,</span>
<span>                       centre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">150000</span>, <span class="fl">6240000</span><span class="op">)</span>,</span>
<span>                       sigma <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                       amplitude <span class="op">=</span> <span class="op">-</span><span class="fl">0.9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.hotspot-methods.html">add.hotspot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">density</span>,</span>
<span>                       centre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">155000</span>, <span class="fl">6285000</span><span class="op">)</span>,</span>
<span>                       sigma <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                       amplitude <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># I will choose to plot in km rather than m (scale = 0.001)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">density</span>, <span class="va">region</span>, scale <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:density"></span>
<img src="GettingStarted_files/figure-html/density-1.png" alt="A density map representing a plausible distributions of animals within the study region."><p class="caption">
Figure 2: A density map representing a plausible distributions of animals within the study region.
</p>
</div>
<p>In some situations you may not need to rely on constructing a density distribution from scratch. Now we will demonstrate how to use a gam to construct the density surface. As I do not have data for this area I will use the density grid I created above as an example dataset. I will fit a gam to this data and then use this to create a new density object. As I need to restrict the predicted values to be greater than zero, I will use a log link with the Gaussian error distribution. This can also be a useful trick if you want to turn something created using the above method, which can look a bit lumpy and bumpy, into a smoother distribution surface. The gam fitted must only use a smooth over x and y to fit the model as no other predictor covariates will be present in the density surface.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First extract the data above - this is simple in this case as we only have a single strata</span></span>
<span><span class="co"># Multi-strata regions will involve combining the density grids for each strata into a </span></span>
<span><span class="co"># single dataset.</span></span>
<span><span class="va">density.data</span> <span class="op">&lt;-</span> <span class="va">density</span><span class="op">@</span><span class="va">density.surface</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">density.data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 4 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -157572.4 ymin: 6241463 xmax: -154890.4 ymax: 6241543</span></span>
<span><span class="co">## CRS:           NA</span></span>
<span><span class="co">##            strata   density         x       y                       geometry</span></span>
<span><span class="co">## 34 St Andrews bay 0.6128054 -157640.4 6241293 POLYGON ((-157390.4 6241543...</span></span>
<span><span class="co">## 35 St Andrews bay 0.5614958 -157140.4 6241293 POLYGON ((-157390.4 6241543...</span></span>
<span><span class="co">## 36 St Andrews bay 0.5125986 -156640.4 6241293 POLYGON ((-156890.4 6241543...</span></span>
<span><span class="co">## 37 St Andrews bay 0.4662975 -156140.4 6241293 POLYGON ((-156390.4 6241543...</span></span>
<span><span class="co">## 38 St Andrews bay 0.4227525 -155640.4 6241293 POLYGON ((-155890.4 6241543...</span></span>
<span><span class="co">## 39 St Andrews bay 0.3821010 -155140.4 6241293 POLYGON ((-155390.4 6241543...</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a simple gam to the data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: nlme</span></span></code></pre>
<pre><code><span><span class="co">## This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">density</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">density.data</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the gam object to create a density object</span></span>
<span><span class="va">gam.density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.density.html">make.density</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                            x.space <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                            fitted.model <span class="op">=</span> <span class="va">fit.gam</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gam.density</span>, <span class="va">region</span>, scale <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:densitygam"></span>
<img src="GettingStarted_files/figure-html/densitygam-1.png" alt="A density map representing a plausible distributions of animals within the study region."><p class="caption">
Figure 3: A density map representing a plausible distributions of animals within the study region.
</p>
</div>
</div>
<div class="section level3">
<h3 id="other-population-parameters">Other Population Parameters<a class="anchor" aria-label="anchor" href="#other-population-parameters"></a>
</h3>
<p>Once we have created a plausible animal density distribution we can go on to define other population parameters. We do this by constructing a population description.</p>
<p>We will assume animals occur in small clusters so we will first create a covariate list and define the distribution for cluster size (which must be named “size”) as a zero-truncated Poisson distribution with mean equal to 3. For those of you familiar with ‘DSsim’ please note the simplified format for defining population covariates.</p>
<p>The other population value we have to define is the population size. As we have clusters in our population, N will refer to the number of clusters rather than individuals. We will set the number of clusters to be 100. We then leave the fixed.N argument as the default TRUE to say we would like to generate the population based on the population size rather than the density surface.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a covariate list describing the distribution of cluster sizes</span></span>
<span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"ztruncpois"</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the population description</span></span>
<span><span class="va">pop.desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.population.description.html">make.population.description</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                                        density <span class="op">=</span> <span class="va">gam.density</span>,</span>
<span>                                        covariates <span class="op">=</span> <span class="va">covariates</span>,</span>
<span>                                        N <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                                        fixed.N <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="coverage-grid">Coverage Grid<a class="anchor" aria-label="anchor" href="#coverage-grid"></a>
</h2>
<p>It is good practice to create a coverage grid over your study area to assess how coverage probability varies spatially across your study area for any specified designs. For designs where there may be non-uniform coverage, we advise coverage probability is assessed prior to running any simulations. However, as this step is not essential for running simulations we will omit it here and refer you to the ‘dssd’ vignettes for further details.</p>
</div>
<div class="section level2">
<h2 id="defining-the-design">Defining the Design<a class="anchor" aria-label="anchor" href="#defining-the-design"></a>
</h2>
<p>‘dsims’ working together with ‘dssd’ provides a number of point and line transect designs. Further details on defining designs can be found in the ‘dssd’ help and vignettes. We also provide examples online at <a href="https://distancedevelopment.github.io/distancesamplingcom2/resources/vignettes.html" class="external-link uri">https://distancedevelopment.github.io/distancesamplingcom2/resources/vignettes.html</a> .</p>
<p>For these simulations we will compare two line transect designs, systematically spaced parallel lines and equal spaced zigzag lines. The zigzag design will be generated within a convex hull to try to minimise the off-effort transit time between the ends of transects.</p>
<p>The design angles for each design were selected so that the transects run roughly perpendicular to the coast. The way the two designs are defined means that this is 90 degrees for the parallel line design and 0 for the zigzag design. Both designs assumed a minus sampling protocol and the truncation distance was set at 750m from the transect. The spacings for each design were selected to give the same trackline lengths of around 450 km (this was assessed by running the coverage simulations for these designs using ‘run.coverage’, see help in ‘dssd’). The trackline lengths can be thought of as an indicator of the cost of the survey as they give the total travel time (both on and off effort) from the beginning of the first transect to the end of the last transect.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parallel.design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dssd/man/make.design.html" class="external-link">make.design</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>, </span>
<span>                               design <span class="op">=</span> <span class="st">"systematic"</span>,</span>
<span>                               spacing <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                               edge.protocol <span class="op">=</span> <span class="st">"minus"</span>,</span>
<span>                               design.angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                               truncation <span class="op">=</span> <span class="fl">750</span><span class="op">)</span></span>
<span></span>
<span><span class="va">zigzag.design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dssd/man/make.design.html" class="external-link">make.design</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>, </span>
<span>                             design <span class="op">=</span> <span class="st">"eszigzag"</span>,</span>
<span>                             spacing <span class="op">=</span> <span class="fl">2233</span>,</span>
<span>                             edge.protocol <span class="op">=</span> <span class="st">"minus"</span>,</span>
<span>                             design.angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                             bounding.shape <span class="op">=</span> <span class="st">"convex.hull"</span>,</span>
<span>                             truncation <span class="op">=</span> <span class="fl">750</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="generating-a-set-of-transects">Generating a Set of Transects<a class="anchor" aria-label="anchor" href="#generating-a-set-of-transects"></a>
</h3>
<p>It is always a good idea to run a quick check that your design is as expected by generating a set of transects and plotting them.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p.survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dssd/man/generate.transects-methods.html" class="external-link">generate.transects</a></span><span class="op">(</span><span class="va">parallel.design</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">p.survey</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:paralleltransects"></span>
<img src="GettingStarted_files/figure-html/paralleltransects-1.png" alt="An example set of transects generated from the systematic parallel line design plotted within the study region."><p class="caption">
Figure 4: An example set of transects generated from the systematic parallel line design plotted within the study region.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z.survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dssd/man/generate.transects-methods.html" class="external-link">generate.transects</a></span><span class="op">(</span><span class="va">zigzag.design</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">z.survey</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:zigzagtransects"></span>
<img src="GettingStarted_files/figure-html/zigzagtransects-1.png" alt="An example set of transects generated from the systematic parallel line design plotted within the study region."><p class="caption">
Figure 5: An example set of transects generated from the systematic parallel line design plotted within the study region.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="defining-detectability">Defining Detectability<a class="anchor" aria-label="anchor" href="#defining-detectability"></a>
</h2>
<p>Once we have defined both the population of interest and the design which we will use to survey our population we now need to provide information about how detectable the individuals or clusters are. For this example we will assume that larger clusters are more detectable. Take care when defining covariate parameters that the covariate names match those in the population description.</p>
<p>When setting the basic scale parameter along side covariate parameters values we need be aware of how the covariate parameter values are incorporated. The covariate parameter values provided adjust the value of the scale parameter on the log scale. The scale parameter for any individual (<span class="math inline">\(\sigma_j\)</span>) can be calculated as:</p>
<p><span class="math display">\[\sigma_j = exp(log(\sigma_0)+\sum_{i=1}^{k}\beta_ix_{ij})\]</span>
where <span class="math inline">\(j\)</span> is the individual, <span class="math inline">\(\sigma_0\)</span> is the base line scale parameter (passed in as argument ‘scale.param’ on the natural scale), the <span class="math inline">\(\beta_i\)</span>’s are the covariate parameters passed in on the log scale for each covariate <span class="math inline">\(i\)</span> and the <span class="math inline">\(x_{ij}\)</span> values are the covariate values for covariate <span class="math inline">\(i\)</span> and individual <span class="math inline">\(j\)</span>.</p>
<p>We will assume a half normal detection function with a scale parameter of 300. We will set the truncation distance to be the same as the design at 750 m. and set the covariate slope coefficient on the log scale to log(1.08) = 0.077. We can check what our detection functions will look like for the different covariate values by plotting them. To plot the example detection functions we need to provide the population description as well as detectability.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the covariate parameters on the log scale</span></span>
<span><span class="va">cov.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.08</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the detectability description</span></span>
<span><span class="va">detect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.detectability.html">make.detectability</a></span><span class="op">(</span>key.function <span class="op">=</span> <span class="st">"hn"</span>,</span>
<span>                             scale.param <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                             cov.param <span class="op">=</span> <span class="va">cov.param</span>,</span>
<span>                             truncation <span class="op">=</span> <span class="fl">750</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the simulation detection functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">detect</span>, <span class="va">pop.desc</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:detect"></span>
<img src="GettingStarted_files/figure-html/detect-1.png" alt="Plot of the detection function for the mean group size (solid line) and for the 2.5 and 97.5 percentile values  of group size (dashed lines) for this population."><p class="caption">
Figure 6: Plot of the detection function for the mean group size (solid line) and for the 2.5 and 97.5 percentile values of group size (dashed lines) for this population.
</p>
</div>
<p>We can also calculate the average detection function for our mean cluster size of 3 as defined in our population description:</p>
<p><span class="math display">\[\sigma_{size = 3} = exp(log(300)+log(1.05)*3) = 347.3 \]</span></p>
</div>
<div class="section level2">
<h2 id="defining-analyses">Defining Analyses<a class="anchor" aria-label="anchor" href="#defining-analyses"></a>
</h2>
<p>The final component to a simulation is the analysis or set of analyses you wish to fit to the simulated data. We will define a number of models and allow automatic model selection based on the minimum AIC value. The models included below are a half-normal with no covariates, a hazard rate with no covariates and a half-normal with cluster size as a covariate. We will leave the truncation value at 750 as previously defined (it must be <span class="math inline">\(\le\)</span> to the truncation values used previously). We will use the default error variance estimator “R2”. See <code><a href="https://rdrr.io/pkg/mrds/man/varn.html" class="external-link">?mrds::varn</a></code> for descriptions of the various empirical variance estimators for encounter rate.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.ds.analysis.html">make.ds.analysis</a></span><span class="op">(</span>dfmodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span>, <span class="op">~</span><span class="fl">1</span>, <span class="op">~</span><span class="va">size</span><span class="op">)</span>,</span>
<span>                             key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hn"</span>, <span class="st">"hr"</span>, <span class="st">"hn"</span><span class="op">)</span>,</span>
<span>                             truncation <span class="op">=</span> <span class="fl">750</span>,</span>
<span>                             er.var <span class="op">=</span> <span class="st">"R2"</span>,</span>
<span>                             criteria <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="putting-the-simulation-together">Putting the Simulation Together<a class="anchor" aria-label="anchor" href="#putting-the-simulation-together"></a>
</h2>
<p>Now we have all the simulation components defined we can create our simulation objects. We will create one for the systematic parallel line design and one for the equal spaced zigzag design.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim.parallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.simulation.html">make.simulation</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">999</span>,</span>
<span>                                design <span class="op">=</span> <span class="va">parallel.design</span>,</span>
<span>                                population.description <span class="op">=</span> <span class="va">pop.desc</span>,</span>
<span>                                detectability <span class="op">=</span> <span class="va">detect</span>,</span>
<span>                                ds.analysis <span class="op">=</span> <span class="va">analyses</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim.zigzag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.simulation.html">make.simulation</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">999</span>,</span>
<span>                              design <span class="op">=</span> <span class="va">zigzag.design</span>,</span>
<span>                              population.description <span class="op">=</span> <span class="va">pop.desc</span>,</span>
<span>                              detectability <span class="op">=</span> <span class="va">detect</span>,</span>
<span>                              ds.analysis <span class="op">=</span> <span class="va">analyses</span><span class="op">)</span></span></code></pre></div>
<p>Once you have created a simulation we recommend you check to see what a simulated survey might look like.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a single instance of a survey: a population, set of transects </span></span>
<span><span class="co"># and the resulting distance data</span></span>
<span><span class="va">eg.parallel.survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.survey-methods.html">run.survey</a></span><span class="op">(</span><span class="va">sim.parallel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot it to view a summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eg.parallel.survey</span>, <span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:parallelsurvey"></span>
<img src="GettingStarted_files/figure-html/parallelsurvey-1.png" alt="Example survey from systematic parallel design. Panels showing: top left - transects, top right - population, bottom left - transects, population and survey detections (cyan dots), bottom right -  histogram of detection distances"><p class="caption">
Figure 7: Example survey from systematic parallel design. Panels showing: top left - transects, top right - population, bottom left - transects, population and survey detections (cyan dots), bottom right - histogram of detection distances
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a single instance of a survey: a population, set of transects </span></span>
<span><span class="co"># and the resulting distance data</span></span>
<span><span class="va">eg.zigzag.survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.survey-methods.html">run.survey</a></span><span class="op">(</span><span class="va">sim.zigzag</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot it to view a summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eg.zigzag.survey</span>, <span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:zigzagsurvey"></span>
<img src="GettingStarted_files/figure-html/zigzagsurvey-1.png" alt="Example survey from equal spaced zigzag design. Panels showing: top left - transects, top right - population, bottom left - transects, population and survey detections (cyan dots), bottom right -  histogram of detection distances"><p class="caption">
Figure 8: Example survey from equal spaced zigzag design. Panels showing: top left - transects, top right - population, bottom left - transects, population and survey detections (cyan dots), bottom right - histogram of detection distances
</p>
</div>
</div>
<div class="section level2">
<h2 id="running-the-simulation">Running the Simulation<a class="anchor" aria-label="anchor" href="#running-the-simulation"></a>
</h2>
<p>The simulations can be run as follows. Note that these will take some time to run!</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Running the simulations</span></span>
<span><span class="va">sim.parallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.simulation-methods.html">run.simulation</a></span><span class="op">(</span><span class="va">sim.parallel</span><span class="op">)</span></span>
<span><span class="va">sim.zigzag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.simulation-methods.html">run.simulation</a></span><span class="op">(</span><span class="va">sim.zigzag</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulation-results">Simulation Results<a class="anchor" aria-label="anchor" href="#simulation-results"></a>
</h2>
<p>Once the simulations have run we can view a summary of the results. Viewing a summary of a simulation will first summarise the simulation setup and then if the simulation has been run provide a summary of the results. A glossary is also provided to aid interpretation of the results. Note that each run will produce slightly different results due to the random component of the generation of both the populations and the sets of survey transects.</p>
<p>Firstly, for the systematic parallel lines design we can see that there is very low bias 1.85% for the estimated abundance/density of individuals. The bias is even lower at only 0.16% for the estimated abundance/density of clusters. Also we can see that the analyses have done a good job at estimating the mean cluster size, there is only 1.72% bias.</p>
<p>We can also see that the 95% confidence intervals calculated for the abundance/density estimates are in fact capturing the true value around 97% of the time (CI.coverage.prob). We can also note that the observed standard deviation of the estimates of the mean is a bit lower than the mean se, meaning we are realising a lower variance than we would estimate. This is often seen with systematic designs as the default variance estimator assumes a completely random allocation of transect locations, systematic designs usually have lower variance.</p>
<p>Reassuringly, these results are as expected for the systematic parallel line design. We expect low bias, as by definition, parallel line designs produce a very uniform coverage probability. The only areas where this design might not produce uniform coverage is around the boundary where there could be minor edge effects due to the minus sampling.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim.parallel</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## GLOSSARY</span></span>
<span><span class="co">## --------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Simulation Output</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Region          : the region name.</span></span>
<span><span class="co">## No. Repetitions : the number of times the simulation was repeated.</span></span>
<span><span class="co">## No. Excluded Repetitions : the number of times the simulation failed</span></span>
<span><span class="co">##                   (too few sightings, model fitting failure etc.)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for Individuals</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary Statistics:</span></span>
<span><span class="co">##    mean.Cover.Area : mean covered across simulation.</span></span>
<span><span class="co">##    mean.Effort     : mean effort across simulation.</span></span>
<span><span class="co">##    mean.n          : mean number of observed objects across</span></span>
<span><span class="co">##                      simulation.</span></span>
<span><span class="co">##    mean.n.miss.dist: mean number of observed objects where no distance</span></span>
<span><span class="co">##                     was recorded (only displayed if value &gt; 0).</span></span>
<span><span class="co">##    no.zero.n       : number of surveys in simulation where</span></span>
<span><span class="co">##                      nothing was detected (only displayed if value &gt; 0).</span></span>
<span><span class="co">##    mean.ER         : mean encounter rate across simulation.</span></span>
<span><span class="co">##    mean.se.ER      : mean standard error of the encounter rates</span></span>
<span><span class="co">##                      across simulation.</span></span>
<span><span class="co">##    sd.mean.ER      : standard deviation of the encounter rates</span></span>
<span><span class="co">##                      across simulation.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimates of Abundance:</span></span>
<span><span class="co">##    Truth            : true population size, (or mean of true</span></span>
<span><span class="co">##                       population sizes across simulation for Poisson N.</span></span>
<span><span class="co">##    mean.Estimate    : mean estimate of abundance across simulation.</span></span>
<span><span class="co">##    percent.bias     : the percentage of bias in the estimates.</span></span>
<span><span class="co">##    RMSE             : root mean squared error/no. successful reps</span></span>
<span><span class="co">##    CI.coverage.prob : proportion of times the 95% confidence interval</span></span>
<span><span class="co">##                       contained the true value.</span></span>
<span><span class="co">##    mean.se          : the mean standard error of the estimates of</span></span>
<span><span class="co">##                       abundance</span></span>
<span><span class="co">##    sd.of.means      : the standard deviation of the estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimates of Density:</span></span>
<span><span class="co">##    Truth            : true average density.</span></span>
<span><span class="co">##    mean.Estimate    : mean estimate of density across simulation.</span></span>
<span><span class="co">##    percent.bias     : the percentage of bias in the estimates.</span></span>
<span><span class="co">##    RMSE             : root mean squared error/no. successful reps</span></span>
<span><span class="co">##    CI.coverage.prob : proportion of times the 95% confidence interval</span></span>
<span><span class="co">##                       contained the true value.</span></span>
<span><span class="co">##    mean.se          : the mean standard error of the estimates.</span></span>
<span><span class="co">##    sd.of.means      : the standard deviation of the estimates.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection Function Values</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  mean.observed.Pa : mean proportion of individuals/clusters observed in</span></span>
<span><span class="co">##                     the covered region.</span></span>
<span><span class="co">##  mean.estimte.Pa  : mean estimate of the proportion of individuals/</span></span>
<span><span class="co">##                     clusters observed in the covered region.</span></span>
<span><span class="co">##  sd.estimate.Pa   : standard deviation of the mean estimates of the</span></span>
<span><span class="co">##                     proportion of individuals/clusters observed in the</span></span>
<span><span class="co">##                     covered region.</span></span>
<span><span class="co">##  mean.ESW         : mean estimated strip width.</span></span>
<span><span class="co">##  sd.ESW           : standard deviation of the mean estimated strip widths.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Region:  St Andrews bay</span></span>
<span><span class="co">## No. Repetitions:  999</span></span>
<span><span class="co">## No. Excluded Repetitions:  0</span></span>
<span><span class="co">## Using only repetitions where all models converged.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Design:  Systematic parallel line design</span></span>
<span><span class="co">##    design.type :  Systematic parallel line design</span></span>
<span><span class="co">##    bounding.shape :  rectangle</span></span>
<span><span class="co">##    spacing :  2500</span></span>
<span><span class="co">##    design.angle :  90</span></span>
<span><span class="co">##    edge.protocol :  minus</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Individual Level Covariate Summary:</span></span>
<span><span class="co">##    size:ztruncpois , mean  =  3</span></span>
<span><span class="co">## Population Detectability Summary:</span></span>
<span><span class="co">##     key.function  =  hn</span></span>
<span><span class="co">##     scale.param  =  300</span></span>
<span><span class="co">##     truncation  =  750</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Covariate Detectability Summary (params on log scale):</span></span>
<span><span class="co">##    size parameters: </span></span>
<span><span class="co">## Strata St Andrews bay </span></span>
<span><span class="co">##            0.07696104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Analysis Summary:</span></span>
<span><span class="co">##    Candidate Models:</span></span>
<span><span class="co">##       Model 1: key function 'hn', formula '~1', was selected 474 time(s).</span></span>
<span><span class="co">##       Model 2: key function 'hr', formula '~1', was selected 201 time(s).</span></span>
<span><span class="co">##       Model 3: key function 'hn', formula '~size', was selected 324 time(s).</span></span>
<span><span class="co">##    criteria  =  AIC</span></span>
<span><span class="co">##    variance.estimator  =  R2</span></span>
<span><span class="co">##    truncation  =  750</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for Individuals</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimates of Abundance (N)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Truth mean.Estimate percent.bias   RMSE CI.coverage.prob mean.se sd.of.means</span></span>
<span><span class="co">## 1   900        916.67         1.85 149.89             0.97  155.99      149.04</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Density (D)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          Truth mean.Estimate percent.bias         RMSE CI.coverage.prob</span></span>
<span><span class="co">## 1 9.113923e-07  9.282781e-07     1.852743 1.517923e-07         0.968969</span></span>
<span><span class="co">##        mean.se  sd.of.means</span></span>
<span><span class="co">## 1 1.579674e-07 1.509258e-07</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for Clusters</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary Statistics</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   mean.Cover.Area mean.Effort   mean.n   mean.k      mean.ER   mean.se.ER</span></span>
<span><span class="co">## 1       592153913    394769.3 106.7317 15.82883 0.0002704223 3.569565e-05</span></span>
<span><span class="co">##     sd.mean.ER</span></span>
<span><span class="co">## 1 2.137828e-05</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Abundance (N)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Truth mean.Estimate percent.bias  RMSE CI.coverage.prob mean.se sd.of.means</span></span>
<span><span class="co">## 1   300        300.49         0.16 45.02             0.97   49.01       45.04</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Density (D)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          Truth mean.Estimate percent.bias        RMSE CI.coverage.prob</span></span>
<span><span class="co">## 1 3.037974e-07  3.042914e-07    0.1626056 4.55915e-08         0.970971</span></span>
<span><span class="co">##        mean.se  sd.of.means</span></span>
<span><span class="co">## 1 4.962823e-08 4.561166e-08</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Expected Cluster Size</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Truth mean.Expected.S percent.bias mean.se.ExpS sd.mean.ExpS</span></span>
<span><span class="co">## 1     3            3.05         1.72         0.16          0.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection Function Values</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   mean.observed.Pa mean.estimate.Pa sd.estimate.Pa mean.ESW sd.ESW</span></span>
<span><span class="co">## 1              0.6              0.6           0.07   451.01  54.08</span></span></code></pre>
<p>We can now check the results for the zigzag design. While zigzag designs generated inside a convex hull can be much more efficient than parallel line designs (less off-effort transit) there is the possibility of non-uniform coverage. The coverage can be assessed by running <code>run.coverage</code> but by itself this does not give much of an indication of the likely effects on the survey results. The degree to which non-uniform coverage may affect survey results is determined not only by the variability in coverage but also in how that combines with the density of animals in the region. Note that while we have run only one density scenario here, if you have non-uniform coverage probability it is advisable to test the effects under a range of plausible animal distributions.</p>
<p>Under this assumed distribution of animals, it looks like any effects of non-uniform coverage are going to have minimal effects on the estimates of abundance / density. For individuals the bias is around 2.5% and for clusters it is 0.65%. Similar to the parallel line design, the confidence intervals are also giving a coverage of 97%.</p>
<p>What we can note is that the improved efficiency of this design has increased our on effort line length and corresponding covered area and is thus giving us a bit better precision than the systematic parallel line design.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim.zigzag</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## GLOSSARY</span></span>
<span><span class="co">## --------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Simulation Output</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Region          : the region name.</span></span>
<span><span class="co">## No. Repetitions : the number of times the simulation was repeated.</span></span>
<span><span class="co">## No. Excluded Repetitions : the number of times the simulation failed</span></span>
<span><span class="co">##                   (too few sightings, model fitting failure etc.)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for Individuals</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary Statistics:</span></span>
<span><span class="co">##    mean.Cover.Area : mean covered across simulation.</span></span>
<span><span class="co">##    mean.Effort     : mean effort across simulation.</span></span>
<span><span class="co">##    mean.n          : mean number of observed objects across</span></span>
<span><span class="co">##                      simulation.</span></span>
<span><span class="co">##    mean.n.miss.dist: mean number of observed objects where no distance</span></span>
<span><span class="co">##                     was recorded (only displayed if value &gt; 0).</span></span>
<span><span class="co">##    no.zero.n       : number of surveys in simulation where</span></span>
<span><span class="co">##                      nothing was detected (only displayed if value &gt; 0).</span></span>
<span><span class="co">##    mean.ER         : mean encounter rate across simulation.</span></span>
<span><span class="co">##    mean.se.ER      : mean standard error of the encounter rates</span></span>
<span><span class="co">##                      across simulation.</span></span>
<span><span class="co">##    sd.mean.ER      : standard deviation of the encounter rates</span></span>
<span><span class="co">##                      across simulation.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimates of Abundance:</span></span>
<span><span class="co">##    Truth            : true population size, (or mean of true</span></span>
<span><span class="co">##                       population sizes across simulation for Poisson N.</span></span>
<span><span class="co">##    mean.Estimate    : mean estimate of abundance across simulation.</span></span>
<span><span class="co">##    percent.bias     : the percentage of bias in the estimates.</span></span>
<span><span class="co">##    RMSE             : root mean squared error/no. successful reps</span></span>
<span><span class="co">##    CI.coverage.prob : proportion of times the 95% confidence interval</span></span>
<span><span class="co">##                       contained the true value.</span></span>
<span><span class="co">##    mean.se          : the mean standard error of the estimates of</span></span>
<span><span class="co">##                       abundance</span></span>
<span><span class="co">##    sd.of.means      : the standard deviation of the estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimates of Density:</span></span>
<span><span class="co">##    Truth            : true average density.</span></span>
<span><span class="co">##    mean.Estimate    : mean estimate of density across simulation.</span></span>
<span><span class="co">##    percent.bias     : the percentage of bias in the estimates.</span></span>
<span><span class="co">##    RMSE             : root mean squared error/no. successful reps</span></span>
<span><span class="co">##    CI.coverage.prob : proportion of times the 95% confidence interval</span></span>
<span><span class="co">##                       contained the true value.</span></span>
<span><span class="co">##    mean.se          : the mean standard error of the estimates.</span></span>
<span><span class="co">##    sd.of.means      : the standard deviation of the estimates.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection Function Values</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  mean.observed.Pa : mean proportion of individuals/clusters observed in</span></span>
<span><span class="co">##                     the covered region.</span></span>
<span><span class="co">##  mean.estimte.Pa  : mean estimate of the proportion of individuals/</span></span>
<span><span class="co">##                     clusters observed in the covered region.</span></span>
<span><span class="co">##  sd.estimate.Pa   : standard deviation of the mean estimates of the</span></span>
<span><span class="co">##                     proportion of individuals/clusters observed in the</span></span>
<span><span class="co">##                     covered region.</span></span>
<span><span class="co">##  mean.ESW         : mean estimated strip width.</span></span>
<span><span class="co">##  sd.ESW           : standard deviation of the mean estimated strip widths.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Region:  St Andrews bay</span></span>
<span><span class="co">## No. Repetitions:  999</span></span>
<span><span class="co">## No. Excluded Repetitions:  0</span></span>
<span><span class="co">## Using only repetitions where all models converged.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Design:  Equal spaced zigzag line design</span></span>
<span><span class="co">##    design.type :  Equal spaced zigzag line design</span></span>
<span><span class="co">##    bounding.shape :  convex.hull</span></span>
<span><span class="co">##    spacing :  2233</span></span>
<span><span class="co">##    design.angle :  0</span></span>
<span><span class="co">##    edge.protocol :  minus</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Individual Level Covariate Summary:</span></span>
<span><span class="co">##    size:ztruncpois , mean  =  3</span></span>
<span><span class="co">## Population Detectability Summary:</span></span>
<span><span class="co">##     key.function  =  hn</span></span>
<span><span class="co">##     scale.param  =  300</span></span>
<span><span class="co">##     truncation  =  750</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Covariate Detectability Summary (params on log scale):</span></span>
<span><span class="co">##    size parameters: </span></span>
<span><span class="co">## Strata St Andrews bay </span></span>
<span><span class="co">##            0.07696104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Analysis Summary:</span></span>
<span><span class="co">##    Candidate Models:</span></span>
<span><span class="co">##       Model 1: key function 'hn', formula '~1', was selected 476 time(s).</span></span>
<span><span class="co">##       Model 2: key function 'hr', formula '~1', was selected 178 time(s).</span></span>
<span><span class="co">##       Model 3: key function 'hn', formula '~size', was selected 345 time(s).</span></span>
<span><span class="co">##    criteria  =  AIC</span></span>
<span><span class="co">##    variance.estimator  =  R2</span></span>
<span><span class="co">##    truncation  =  750</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for Individuals</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimates of Abundance (N)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Truth mean.Estimate percent.bias   RMSE CI.coverage.prob mean.se sd.of.means</span></span>
<span><span class="co">## 1   900        922.42         2.49 134.29             0.97  145.28      132.47</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Density (D)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          Truth mean.Estimate percent.bias         RMSE CI.coverage.prob</span></span>
<span><span class="co">## 1 9.113923e-07  9.340926e-07     2.490729 1.359901e-07         0.971972</span></span>
<span><span class="co">##        mean.se  sd.of.means</span></span>
<span><span class="co">## 1 1.471139e-07 1.341493e-07</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for Clusters</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary Statistics</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   mean.Cover.Area mean.Effort   mean.n   mean.k      mean.ER   mean.se.ER</span></span>
<span><span class="co">## 1       663209990      442140 120.3654 18.47948 0.0002722232 3.346453e-05</span></span>
<span><span class="co">##     sd.mean.ER</span></span>
<span><span class="co">## 1 2.143639e-05</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Abundance (N)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Truth mean.Estimate percent.bias  RMSE CI.coverage.prob mean.se sd.of.means</span></span>
<span><span class="co">## 1   300        301.94         0.65 41.32             0.97   45.58       41.29</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Density (D)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          Truth mean.Estimate percent.bias        RMSE CI.coverage.prob</span></span>
<span><span class="co">## 1 3.037974e-07  3.057631e-07    0.6470286 4.18412e-08         0.973974</span></span>
<span><span class="co">##        mean.se  sd.of.means</span></span>
<span><span class="co">## 1 4.616181e-08 4.181593e-08</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Estimates of Expected Cluster Size</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Truth mean.Expected.S percent.bias mean.se.ExpS sd.mean.ExpS</span></span>
<span><span class="co">## 1     3            3.06         1.97         0.15          0.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">##      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection Function Values</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   mean.observed.Pa mean.estimate.Pa sd.estimate.Pa mean.ESW sd.ESW</span></span>
<span><span class="co">## 1              0.6              0.6           0.07   450.54  49.27</span></span></code></pre>
<p>Histograms of the estimates of abundance from each of the simulation replicates can also be viewed to check for the possible effects of extreme values or skewed distributions.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/histogram.N.ests-methods.html">histogram.N.ests</a></span><span class="op">(</span><span class="va">sim.parallel</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/histogram.N.ests-methods.html">histogram.N.ests</a></span><span class="op">(</span><span class="va">sim.zigzag</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:histresults"></span>
<img src="GettingStarted_files/figure-html/histresults-1.png" alt="Left - histogram of estimates of abundance of clusters for systematic parallel design. Right - histogram of estimates of abundance of clusters for zigzag design."><p class="caption">
Figure 9: Left - histogram of estimates of abundance of clusters for systematic parallel design. Right - histogram of estimates of abundance of clusters for zigzag design.
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldparams</span><span class="op">)</span></span></code></pre></div>
<p>We can see in Figure <a href="#fig:histresults">9</a> that there were a couple of high estimates generated &gt;500 for both the parallel line and zigzag designs. These probably represent data sets that were difficult to fit a model too (perhaps a chance spiked data set). Most of the estimates are centered around truth but these occasional high estimates may have increased the mean value slightly and could be associated with the small amount of positive bias.</p>
</div>
<div class="section level2">
<h2 id="simulation-conclusions">Simulation Conclusions<a class="anchor" aria-label="anchor" href="#simulation-conclusions"></a>
</h2>
<p>Under these simulation assumptions it appears that the zigzag design will cost us a little in accuracy but allow us to gain some precision. It should be noted that the cost in accuracy will vary depending on the distribution of animals in the survey region.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-DSsim-pkg" class="csl-entry">
Marshall, L. 2020. <em>DSsim: Distance Sampling Simulations</em>. <a href="https://CRAN.R-project.org/package=DSsim" class="external-link">https://CRAN.R-project.org/package=DSsim</a>.
</div>
<div id="ref-dsims-pkg" class="csl-entry">
Marshall, Laura. 2023a. <em>Dsims: Distance Sampling Simulations</em>. <a href="https://CRAN.R-project.org/package=dsims" class="external-link">https://CRAN.R-project.org/package=dsims</a>.
</div>
<div id="ref-dssd-pkg" class="csl-entry">
———. 2023b. <em>Dssd: Distance Sampling Survey Design</em>. <a href="https://CRAN.R-project.org/package=dssd" class="external-link">https://CRAN.R-project.org/package=dssd</a>.
</div>
<div id="ref-Distance-pkg" class="csl-entry">
Miller, David L., Eric Rexstad, Len Thomas, Laura Marshall, and Jeffrey L. Laake. 2019. <span>“Distance Sampling in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 89 (1): 1–28. <a href="https://doi.org/10.18637/jss.v089.i01" class="external-link">https://doi.org/10.18637/jss.v089.i01</a>.
</div>
<div id="ref-sf-pkg" class="csl-entry">
Pebesma, Bivand, E., and D. Baston. 2021. <em>Sf: Simple Features for r</em>. <a href="https://CRAN.R-project.org/package=sf" class="external-link">https://CRAN.R-project.org/package=sf</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer>
</div>





  </body>
</html>
